# 金融数据分析系统

## 项目概述

这是一个基于 Python 的金融数据分析系统，主要用于股票估值分析、基金数据分析、宏观经济数据获取等功能。系统整合了多个金融数据源，为投资决策提供数据支持。

## 主要功能

### 1. 估值分析
- DCF 现金流折现估值
- 实时市值获取
- 无风险收益率计算
- 估值模型对比分析

### 2. 数据获取
- 股票基本面数据
- 基金数据
- 宏观经济指标
- 市场行情数据

### 3. 特色功能
- 机构调研分析
- ESG 评级分析
- 市场活跃度分析
- 资金流向监控

## 技术架构

### 核心模块
```
project/
├── valuation_model.py      # 估值模型
├── financial_processor.py  # 财务数据处理
├── data_fetcher/          # 数据获取模块
│   ├── stock_data.py
│   ├── fund_data.py
│   └── macro_data.py
└── utils/                 # 工具函数
    ├── data_processor.py
    └── validators.py
```

### 依赖库
- pandas: 数据处理
- requests: HTTP 请求
- akshare: 金融数据接口
- bs4: 网页解析
- tqdm: 进度条显示

## 开发指南

### 1. 环境配置
```bash
# 创建虚拟环境
python -m venv venv

# 激活虚拟环境
source venv/bin/activate  # Linux/Mac
venv\Scripts\activate     # Windows

# 安装依赖
pip install -r requirements.txt
```

### 2. 代码规范
- 遵循 PEP 8 编码规范
- 使用类型注解
- 编写单元测试
- 添加详细注释

### 3. 模块开发流程
1. 创建功能分支
2. 编写代码和测试
3. 提交代码审查
4. 合并到主分支

## API 文档

### ValuationModel 类
```python
class ValuationModel:
    def get_market_cap(stock_code: str) -> Tuple[Optional[float], Optional[str]]:
        """获取实时市值"""
        
    def calculate_risk_free_return(
        initial_amount: float,
        years: int,
        risk_free_rate: float
    ) -> float:
        """计算无风险收益"""
```

### 数据获取接口
```python
def get_stock_fundamental(stock_code: str) -> pd.DataFrame:
    """获取股票基本面数据"""

def get_fund_data(fund_code: str) -> pd.DataFrame:
    """获取基金数据"""

def get_macro_indicators() -> pd.DataFrame:
    """获取宏观经济指标"""
```

## 数据源说明

### 1. 股票数据
- 东方财富网
- 新浪财经
- 巨潮资讯网

### 2. 基金数据
- 天天基金网
- 基金业协会

### 3. 宏观数据
- 金十数据
- 国家统计局
- 央行官网

## 常见问题

1. 数据获取失败
- 检查网络连接
- 验证 API 密钥
- 查看请求频率限制

2. 估值结果异常
- 检查输入参数
- 验证数据有效性
- 查看计算逻辑

## 后续优化计划

### 1. 功能优化
- [ ] 添加数据缓存机制
- [ ] 增加数据可视化模块
- [ ] 添加机器学习预测模型
- [ ] 实现实时预警功能

### 2. 性能优化
- [ ] 优化数据查询效率
- [ ] 实现并行处理
- [ ] 添加数据预加载
- [ ] 优化内存使用

### 3. 架构优化
- [ ] 引入消息队列
- [ ] 添加日志系统
- [ ] 完善错误处理
- [ ] 优化代码结构

## 贡献指南

1. Fork 项目
2. 创建功能分支
3. 提交变更
4. 发起 Pull Request

## 版本历史

- v1.0.0 (2024-01-01)
  - 初始版本发布
  - 实现基本估值功能
  - 完成数据获取模块

## 许可证

MIT License

## 联系方式

- 项目维护者: [待补充]
- 邮箱: [待补充]
- 项目地址: [待补充]

## DCF 估值法说明

DCF 是一种通过预测公司未来现金流，并将其折现到现值的估值方法。其核心理念是："一元钱在今天比在未来更值钱"。

### DCF 估值的主要步骤

1. 预测未来自由现金流（FCF）
   - 通常预测 5-10 年
   - 自由现金流 = 营业利润(1-税率) + 折旧摊销 - 资本支出 - 营运资本变动

2. 计算终值（Terminal Value）
   - 使用永续增长模型（戈登增长模型）
   - 终值 = FCF(n+1) / (r-g)
   - 其中：r 为折现率，g 为永续增长率

3. 确定适当的折现率
   - 通常使用加权平均资本成本（WACC）
   - WACC = 权益成本×权益比例 + 债务成本×(1-税率)×债务比例

4. 计算现值
   - 将未来现金流折现到现在
   - 现值 = 未来现金流 / (1+折现率)^n

### 示例计算

基础数据：
- 当前年度现金流：1亿元
- 预期增长率：10%
- 折现率：12%
- 预测期：5年
- 永续增长率：3%

计算过程：
- 第1年现金流：1.1亿 → 现值：0.982亿
- 第2年现金流：1.21亿 → 现值：0.964亿
- 第3年现金流：1.331亿 → 现值：0.947亿
- 第4年现金流：1.464亿 → 现值：0.930亿
- 第5年现金流：1.611亿 → 现值：0.914亿

终值计算：
- 终值 = 1.611 × (1 + 3%) / (12% - 3%) = 18.37亿
- 终值现值 = 18.37 / (1 + 12%)^5 = 10.42亿

公司价值 = 现金流现值之和 + 终值现值
        = 4.737亿 + 10.42亿
        = 15.157亿
```

